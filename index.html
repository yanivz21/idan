<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משחק סנייק</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 5px solid white;
            margin-top: 20px;
        }
        #score {
            font-size: 24px;
            margin: 10px;
        }
        .control-button {
            width: 50px;
            height: 50px;
            margin: 5px;
            font-size: 24px;
            border: none;
            color: white;
            cursor: pointer;
        }
        .up { background-color: #FF5733; }
        .down { background-color: #33FF57; }
        .left { background-color: #3357FF; }
        .right { background-color: #FF33A1; }
        #restartButton {
            display: none;
            margin-top: 20px;
        }
        #reward {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 24px;
            color: #333;
        }
    </style>
</head>
<body>
    <div id="score">ניקוד: 0</div>
    <canvas id="gameCanvas" width="600" height="400"></canvas>
    <div id="controls">
        <button class="control-button up">↑</button>
        <div>
            <button class="control-button left">←</button>
            <button class="control-button right">→</button>
        </div>
        <button class="control-button down">↓</button>
    </div>
    <button id="restartButton" onclick="restartGame()">אני עדיין רעב, תחזור מיד לשחק!</button>
    <div id="reward">
        <img id="rewardImage" src="rewardImage.png" alt="פרס" style="width: 100px; height: auto;">
        <div>הרווחת את זה ביושר! תהנה</div>
        <div id="timer"></div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const gridSize = 20;
        let snake = [{ x: 8, y: 8 }];
        let snakeDirection = { x: 1, y: 0 };
        let food = { x: Math.floor(Math.random() * (canvas.width / gridSize)), y: Math.floor(Math.random() * (canvas.height / gridSize)) };
        let score = 0;
        let gameInterval;
        let gameStarted = false;
        let rewardActive = false;
        let timer = 10; // טיימר של 10 שניות
        let speed = 0.15; // מהירות ברירת מחדל
        let rewardImage = new Image();
        rewardImage.src = 'rewardImage.png'; // ודא שהקובץ קיים

        // הוספת הצליל
        const eatSound = new Audio('eatSound.mp3'); // ודא שהקובץ קיים בתיקיה

        // קביעת מהירות
        function setSpeed() {
            if (window.innerWidth < 768) { // אם מדובר בטלפון (רוחב קטן מ-768 פיקסלים)
                speed = 0.20; // מהירות איטית יותר
            } else {
                speed = 0.15; // מהירות מהירה יותר
            }
        }

        // שינוי בתחילת המשחק
        function startGame() {
            setSpeed(); // קבע את המהירות בתחילת המשחק
            snake = [{ x: 8, y: 8 }];
            snakeDirection = { x: 1, y: 0 };
            score = 0;
            document.getElementById('score').innerText = `ניקוד: ${score}`;
            food = { x: Math.floor(Math.random() * (canvas.width / gridSize)), y: Math.floor(Math.random() * (canvas.height / gridSize)) };
            document.getElementById('restartButton').style.display = 'none';
            document.getElementById('reward').style.display = 'none'; // מסתיר את התמונה
            startGameLoop();
        }

        // ניהול כיוונים
        document.querySelector('.up').onclick = () => { if (snakeDirection.y === 0) snakeDirection = { x: 0, y: -1 }; };
        document.querySelector('.down').onclick = () => { if (snakeDirection.y === 0) snakeDirection = { x: 0, y: 1 }; };
        document.querySelector('.left').onclick = () => { if (snakeDirection.x === 0) snakeDirection = { x: -1, y: 0 }; };
        document.querySelector('.right').onclick = () => { if (snakeDirection.x === 0) snakeDirection = { x: 1, y: 0 }; };

        function updateSnake() {
            const newHead = { x: snake[0].x + snakeDirection.x, y: snake[0].y + snakeDirection.y };
            snake.unshift(newHead);

            if (newHead.x === food.x && newHead.y === food.y) {
                score++;
                document.getElementById('score').innerText = `ניקוד: ${score}`;
                food = { x: Math.floor(Math.random() * (canvas.width / gridSize)), y: Math.floor(Math.random() * (canvas.height / gridSize)) };

                // נגן את הצליל כשנוגסים בהמבורגר
                eatSound.play(); 

                // אם הניקוד מגיע ל-5, הצג את התמונה עם הטיימר
                if (score === 5) {
                    showReward();
                }
            } else {
                snake.pop();
            }
        }

        function checkCollision() {
            const head = snake[0];
            // בדוק אם הנחש פוגע בקירות
            if (head.x < 0 || head.x >= canvas.width / gridSize || head.y < 0 || head.y >= canvas.height / gridSize) {
                endGame();
            }
            // בדוק אם הנחש פוגע בעצמו
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    endGame();
                }
            }
        }

        function drawSnake() {
            ctx.fillStyle = 'green';
            for (const segment of snake) {
                ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
            }
        }

        function drawFood() {
            ctx.drawImage(rewardImage, food.x * gridSize, food.y * gridSize, gridSize, gridSize); // מציג את ההמבורגר
        }

        function endGame() {
            cancelAnimationFrame(gameInterval);
            document.getElementById('restartButton').style.display = 'block';
        }

        function showReward() {
            rewardActive = true;
            document.getElementById('reward').style.display = 'block';
            document.getElementById('timer').innerText = `טיימר: ${timer}`;
            const interval = setInterval(() => {
                timer--;
                document.getElementById('timer').innerText = `טיימר: ${timer}`;
                if (timer <= 0) {
                    clearInterval(interval);
                    rewardActive = false;
                    document.getElementById('reward').style.display = 'none';
                }
            }, 1000);
        }

        function startGameLoop() {
            updateSnake();
            checkCollision();
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawFood();
            drawSnake();
            gameInterval = setTimeout(startGameLoop, speed * 1000); // עדכון מהירות תנועה
        }

        startGame(); // התחלת המשחק
    </script>
</body>
</html>
